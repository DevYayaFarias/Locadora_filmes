catalogo = {
    "0001": {"nome": "Matrix", "ano": 1999, "genero": "Ficção", "disponibilidade": "disponível",
             "diretor": "Lana Wachowski, Lilly Wachowski", "empresa produtora": "Warner Bros.", "avaliação": 87},
    "0002": {"nome": "Titanic", "ano": 1997, "genero": "Romance", "disponibilidade": "disponível",
             "diretor": "James Cameron", "empresa produtora": "Paramount Pictures", "avaliação": 89},
    "0003": {"nome": "Vingadores", "ano": 2012, "genero": "Ação", "disponibilidade": "disponível",
             "diretor": "Joss Whedon", "empresa produtora": "Marvel Studios", "avaliação": 91},
    "0004": {"nome": "Shrek", "ano": 2001, "genero": "Animação", "disponibilidade": "disponível",
             "diretor": "Andrew Adamson, Vicky Jenson", "empresa produtora": "DreamWorks Animation", "avaliação": 88},
    "0005": {"nome": "Coringa", "ano": 2019, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Todd Phillips", "empresa produtora": "Warner Bros.", "avaliação": 68},
    "0006": {"nome": "Interestelar", "ano": 2014, "genero": "Ficção", "disponibilidade": "disponível",
             "diretor": "Christopher Nolan", "empresa produtora": "Paramount Pictures", "avaliação": 86},
    "0007": {"nome": "O Senhor dos Anéis", "ano": 2001, "genero": "Fantasia", "disponibilidade": "disponível",
             "diretor": "Peter Jackson", "empresa produtora": "New Line Cinema", "avaliação": 91},
    "0008": {"nome": "Harry Potter", "ano": 2001, "genero": "Fantasia", "disponibilidade": "disponível",
             "diretor": "Chris Columbus", "empresa produtora": "Warner Bros.", "avaliação": 81},
    "0009": {"nome": "Star Wars", "ano": 1977, "genero": "Ficção", "disponibilidade": "disponível",
             "diretor": "George Lucas", "empresa produtora": "Lucasfilm", "avaliação": 92},
    "0010": {"nome": "Jurassic Park", "ano": 1993, "genero": "Aventura", "disponibilidade": "disponível",
             "diretor": "Steven Spielberg", "empresa produtora": "Universal Pictures", "avaliação": 91},
    "0011": {"nome": "O Poderoso Chefão", "ano": 1972, "genero": "Crime", "disponibilidade": "disponível",
             "diretor": "Francis Ford Coppola", "empresa produtora": "Paramount Pictures", "avaliação": 98},
    "0012": {"nome": "Casablanca", "ano": 1942, "genero": "Romance", "disponibilidade": "disponível",
             "diretor": "Michael Curtiz", "empresa produtora": "Warner Bros.", "avaliação": 97},
    "0013": {"nome": "O Senhor dos Anéis: As Duas Torres", "ano": 2002, "genero": "Fantasia",
             "disponibilidade": "disponível", "diretor": "Peter Jackson", "empresa produtora": "New Line Cinema",
             "avaliação": 95},
    "0014": {"nome": "O Senhor dos Anéis: O Retorno do Rei", "ano": 2003, "genero": "Fantasia",
             "disponibilidade": "disponível", "diretor": "Peter Jackson", "empresa produtora": "New Line Cinema",
             "avaliação": 93},
    "0015": {"nome": "O Grande Lebowski", "ano": 1998, "genero": "Comédia", "disponibilidade": "disponível",
             "diretor": "Joel Coen, Ethan Coen", "empresa produtora": "PolyGram Filmed Entertainment", "avaliação": 83},
    "0016": {"nome": "Pulp Fiction", "ano": 1994, "genero": "Crime", "disponibilidade": "disponível",
             "diretor": "Quentin Tarantino", "empresa produtora": "Miramax Films", "avaliação": 92},
    "0017": {"nome": "O Rei Leão", "ano": 1994, "genero": "Animação", "disponibilidade": "disponível",
             "diretor": "Roger Allers, Rob Minkoff", "empresa produtora": "Walt Disney Feature Animation",
             "avaliação": 93},
    "0018": {"nome": "Forrest Gump", "ano": 1994, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Robert Zemeckis", "empresa produtora": "Paramount Pictures", "avaliação": 71},
    "0019": {"nome": "O Silêncio dos Inocentes", "ano": 1991, "genero": "Terror", "disponibilidade": "disponível",
             "diretor": "Jonathan Demme", "empresa produtora": "Orion Pictures", "avaliação": 96},
    "0020": {"nome": "Clube da Luta", "ano": 1999, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "David Fincher", "empresa produtora": "20th Century Fox", "avaliação": 79},
    "0021": {"nome": "O Exorcista", "ano": 1973, "genero": "Terror", "disponibilidade": "disponível",
             "diretor": "William Friedkin", "empresa produtora": "Warner Bros.", "avaliação": 84},
    "0022": {"nome": "O Iluminado", "ano": 1980, "genero": "Terror", "disponibilidade": "disponível",
             "diretor": "Stanley Kubrick", "empresa produtora": "Warner Bros.", "avaliação": 93},
    "0023": {"nome": "O Labirinto do Fauno", "ano": 2006, "genero": "Fantasia", "disponibilidade": "disponível",
             "diretor": "Guillermo del Toro", "empresa produtora": "Warner Bros.", "avaliação": 95},
    "0024": {"nome": "O Pianista", "ano": 2002, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Roman Polanski", "empresa produtora": "Canal+", "avaliação": 85},
    "0025": {"nome": "O Cavaleiro das Trevas", "ano": 2008, "genero": "Ação", "disponibilidade": "disponível",
             "diretor": "Christopher Nolan", "empresa produtora": "Warner Bros.", "avaliação": 94},
    "0026": {"nome": "A Origem", "ano": 2010, "genero": "Ficção", "disponibilidade": "disponível",
             "diretor": "Christopher Nolan", "empresa produtora": "Warner Bros.", "avaliação": 86},
    "0027": {"nome": "O Lobo de Wall Street", "ano": 2013, "genero": "Comédia", "disponibilidade": "disponível",
             "diretor": "Martin Scorsese", "empresa produtora": "Paramount Pictures", "avaliação": 79},
    "0028": {"nome": "A Lista de Schindler", "ano": 1993, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Steven Spielberg", "empresa produtora": "Universal Pictures", "avaliação": 93},
    "0029": {"nome": "O Poderoso Chefão: Parte II", "ano": 1974, "genero": "Crime", "disponibilidade": "disponível",
             "diretor": "Francis Ford Coppola", "empresa produtora": "Paramount Pictures", "avaliação": 97},
    "0030": {"nome": "O Poderoso Chefão: Parte III", "ano": 1990, "genero": "Crime", "disponibilidade": "disponível",
             "diretor": "Francis Ford Coppola", "empresa produtora": "Paramount Pictures", "avaliação": 68},
    "0031": {"nome": "O Grande Hotel Budapeste", "ano": 2014, "genero": "Comédia", "disponibilidade": "disponível",
             "diretor": "Wes Anderson", "empresa produtora": "Fox Searchlight Pictures", "avaliação": 91},
    "0032": {"nome": "O Menino do Pijama Listrado", "ano": 2008, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Mark Herman", "empresa produtora": "Miramax Films", "avaliação": 74},
    "0033": {"nome": "O Regresso", "ano": 2015, "genero": "Aventura", "disponibilidade": "disponível",
             "diretor": "Alejandro González Iñárritu", "empresa produtora": "20th Century Fox", "avaliação": 78},
    "0034": {"nome": "O Discurso do Rei", "ano": 2010, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Tom Hooper", "empresa produtora": "The Weinstein Company", "avaliação": 86},
    "0035": {"nome": "O Labirinto de Pan", "ano": 2006, "genero": "Fantasia", "disponibilidade": "disponível",
             "diretor": "Guillermo del Toro", "empresa produtora": "Warner Bros.", "avaliação": 95},
    "0036": {"nome": "O Grande Truque", "ano": 2006, "genero": "Mistério", "disponibilidade": "disponível",
             "diretor": "Christopher Nolan", "empresa produtora": "Warner Bros.", "avaliação": 92},
    "0037": {"nome": "O Quarto de Jack", "ano": 2015, "genero": "Drama", "disponibilidade": "disponível",
             "diretor": "Lenny Abrahamson", "empresa produtora": "Element Pictures", "avaliação": 93}
}

filme_selecionado_id = ""
tentar_novamente = ""
filmes_para_alugar_ids = []
num_filmes = 0

print("_-_-_- Bem-vindo à sessão de aluguel de filmes! -_-_-_")
print()


def filtrar_catalogo(catalogo_atual):
    filtros = {}
    while True:
        print("Deseja filtrar o catálogo por:")
        print("1. Gênero")
        print("2. Ano")
        print("3. Diretor")
        print("4. Empresa Produtora")
        print("5. Avaliação (mínima)")
        print("6. Mostrar todos os filtros aplicados e resultados")
        print("7. Limpar filtros")
        print("0. Sair da filtragem e continuar")
        opcao = input("Digite o número da sua opção: ")
        print()

        if opcao == '1':
            genero = input("Digite o gênero desejado: ").strip()
            filtros['genero'] = genero
        elif opcao == '2':
            try:
                ano = int(input("Digite o ano desejado: ").strip())
                filtros['ano'] = ano
            except ValueError:
                print("Ano inválido. Por favor, digite um número.")
        elif opcao == '3':
            diretor = input("Digite o nome do diretor: ").strip()
            filtros['diretor'] = diretor
        elif opcao == '4':
            empresa = input("Digite o nome da empresa produtora: ").strip()
            filtros['empresa produtora'] = empresa
        elif opcao == '5':
            try:
                avaliacao = int(input("Digite a avaliação mínima desejada (0-100): ").strip())
                if 0 <= avaliacao <= 100:
                    filtros['avaliação'] = avaliacao
                else:
                    print("Avaliação inválida. Digite um número entre 0 e 100.")
            except ValueError:
                print("Avaliação inválida. Por favor, digite um número.")
        elif opcao == '6':
            if not filtros:
                print("Nenhum filtro aplicado ainda.")
            else:
                print("\n--- Filtros Atuais ---")
                for key, value in filtros.items():
                    print(f"{key.capitalize()}: {value}")
                print("----------------------")

            filmes_filtrados = {}
            for filme_id, dados_filme in catalogo_atual.items():
                match = True
                for criterio, valor_filtro in filtros.items():
                    if criterio == 'avaliação':
                        if dados_filme.get(criterio, 0) < valor_filtro:
                            match = False
                            break
                    elif criterio in dados_filme:
                        if isinstance(dados_filme[criterio], str) and isinstance(valor_filtro, str):
                            if valor_filtro.lower() not in dados_filme[criterio].lower():
                                match = False
                                break
                        elif dados_filme[criterio] != valor_filtro:
                            match = False
                            break
                    else:  # Se o critério não existe no filme, ele não corresponde
                        match = False
                        break
                if match:
                    filmes_filtrados[filme_id] = dados_filme

            if filmes_filtrados:
                print("\n--- Filmes Encontrados (Filtrados) ---")
                for filme_id, dados_filme in filmes_filtrados.items():
                    print(
                        f"Código: {filme_id} - Nome: {dados_filme['nome']} (Gênero: {dados_filme['genero']}, Ano: {dados_filme['ano']})")
                print("--------------------------------------\n")
            else:
                print("Nenhum filme encontrado com os filtros aplicados.")

        elif opcao == '7':
            filtros = {}
            print("Filtros limpos com sucesso!")
        elif opcao == '0':
            print("Saindo da filtragem.")
            break
        else:
            print("Opção inválida. Por favor, tente novamente.")

        continuar_filtrando = input("Deseja aplicar mais filtros ou ver o catálogo filtrado novamente? (s/n): ")
        print()
        if continuar_filtrando.lower() == 'n':
            break

    return filtros


# Chamada inicial para a filtragem
filtros_aplicados = filtrar_catalogo(catalogo)

# Aplica os filtros ao catálogo original para as próximas operações
catalogo_filtrado = {}
if filtros_aplicados:
    for filme_id, dados_filme in catalogo.items():
        match = True
        for criterio, valor_filtro in filtros_aplicados.items():
            if criterio == 'avaliação':
                if dados_filme.get(criterio, 0) < valor_filtro:
                    match = False
                    break
            elif criterio in dados_filme:
                if isinstance(dados_filme[criterio], str) and isinstance(valor_filtro, str):
                    if valor_filtro.lower() not in dados_filme[criterio].lower():
                        match = False
                        break
                elif dados_filme[criterio] != valor_filtro:
                    match = False
                    break
            else:
                match = False
                break
        if match:
            catalogo_filtrado[filme_id] = dados_filme
else:
    catalogo_filtrado = catalogo.copy()  # Se nenhum filtro, usa o catálogo completo


## Informações sobre Filmes

while True:
    filme_id_input = input(
        "Deseja informações sobre algum filme específico? (Ano / Gênero / Se ele está disponível...)\nDigite o CÓDIGO dele! (n para sair): ")
    print()

    if filme_id_input.lower() == "n":
        break

    if filme_id_input in catalogo_filtrado:  # Busca no catálogo já filtrado
        dados = catalogo_filtrado[filme_id_input]
        print(f"_-_-_-{dados['nome'].upper()} (CÓDIGO: {filme_id_input})-_-_-_")
        print()
        for chave, valor in dados.items():
            print(f"{chave.capitalize()}: {valor}")
        print()
        break
    else:
        print("Código de filme não encontrado no catálogo filtrado ou resposta inválida.")
        tentar_novamente = input("Deseja tentar novamente? (s/n): ")
        print()
        while tentar_novamente.lower() not in ["s", "n"]:
            print("Inválido! Tente novamente!")
            tentar_novamente = input("Deseja tentar novamente? (s/n): ")
            print()

        if tentar_novamente.lower() == "s":
            continue
        elif tentar_novamente.lower() == "n":
            break

while filme_id_input.lower() != "n" and tentar_novamente.lower() != "n":
    interesse_id = input(
        "Quer saber mais sobre algum outro filme? (Ano / Gênero / Se ele está disponível)\nDigite o CÓDIGO dele! (n para sair): ")
    print()

    if interesse_id.lower() == "n":
        break

    if interesse_id in catalogo_filtrado:  # Busca no catálogo já filtrado
        dados = catalogo_filtrado[interesse_id]
        print(f"_-_-_-{dados['nome'].upper()} (CÓDIGO: {interesse_id})-_-_-_")
        for chave, valor in dados.items():
            print(f"{chave.capitalize()}: {valor}")
        print()
        continue
    else:
        print("Código de filme inválido no catálogo filtrado, favor tentar novamente.")
        print()


## Aluguel de Filmes


print("_-_-_- ALUGUEL -_-_-_")
print()
alugar_filme = input("Deseja alugar algum filme? (s/n): ")
print()

while True:
    if alugar_filme.lower() == "s":
        while True:
            quantos_alugar_str = input("Quantos filmes você deseja alugar? (máx - 100): ")
            print()

            try:
                quantos = int(quantos_alugar_str)
            except ValueError:
                print("Você não digitou um número! Tente novamente!")
                print()
                continue

            if not (1 <= quantos <= 100):
                print("Valor inválido, por favor digite outra quantidade (entre 1 e 100).")
                print()
                continue

            num_filmes = quantos
            i = 0

            while i < num_filmes:
                filme_id_alugar = input(f"Digite o CÓDIGO do {i + 1}º filme (ou 0 para sair): ")
                print()

                if filme_id_alugar == '0':
                    break

                # Verifica a disponibilidade no catálogo original, não no filtrado, pois o estado de disponibilidade é global.
                if filme_id_alugar in catalogo:
                    if catalogo[filme_id_alugar]["disponibilidade"].lower() == "disponível":
                        filmes_para_alugar_ids.append(filme_id_alugar)
                        catalogo[filme_id_alugar]["disponibilidade"] = "indisponível"
                        i += 1
                    else:
                        print(
                            f"Desculpe, o filme '{catalogo[filme_id_alugar]['nome']}' (CÓDIGO: {filme_id_alugar}) está indisponível no momento ou já foi inserido.")
                        print()
                else:
                    print(f"Infelizmente não encontramos filme com o código '{filme_id_alugar}'.")
                    print()
            break
        break

    elif alugar_filme.lower() == "n":
        print("_-_-_- Obrigado por acessar nossa locadora! -_-_-_")
        break

    else:
        print("Você não digitou um valor válido, por favor tente novamente!")
        alugar_filme = input("Deseja alugar algum filme? (s/n): ")
        print()

if filmes_para_alugar_ids or alugar_filme.lower() == "s":
    print("Esses são os filmes que você escolheu:")
    for filme_id in filmes_para_alugar_ids:
        print(f"- {catalogo[filme_id]['nome']} (CÓDIGO: {filme_id})")
    print()
    fim_aluguel = input(
        "Deseja finalizar aluguel? ('s' para continuar / 'n' para cancelar / qualquer coisa para escolher filmes novamente): ")
    print()

    if fim_aluguel.lower() == 's':
        print(f"O total ficou R${len(filmes_para_alugar_ids) * 15:.2f}, para {len(filmes_para_alugar_ids)} filme(s).")
        print("Obrigado por alugar com a gente!")
    elif fim_aluguel.lower() == 'n':
        for filme_id_alugado in filmes_para_alugar_ids:
            catalogo[filme_id_alugado]["disponibilidade"] = "disponível"
        filmes_para_alugar_ids = []
        print("Seu pedido foi cancelado.")
    else:
        for filme_id_alugado in filmes_para_alugar_ids:
            catalogo[filme_id_alugado]["disponibilidade"] = "disponível"
        filmes_para_alugar_ids = []
        print("Sessão de aluguel reiniciada. Por favor, comece novamente a seleção de filmes.")